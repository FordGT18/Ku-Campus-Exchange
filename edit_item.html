<!--
  Author: Juan Vargas
  Project: KU Campus Exchange
  File: edit_item.html
  Description: front end for editing listings on Marketplace
-->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Edit Item</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style2.css">
<link rel="stylesheet" href="edit_item.css">
</head>
<body>
<div class="wrap">
  <div class="top">
    <a class="btn secondary" href="profile.php">‚Üê Back to Profile</a>
    <form action="delete_item.php" method="get">
      <input type="hidden" name="id" value="<?= (int)$item['id'] ?>">
      <button class="btn danger" type="submit">Delete Item</button>
    </form>
  </div>

  <div class="card">
    <form action="edit_item.php" method="post" enctype="multipart/form-data">
      <input type="hidden" name="id" value="<?= (int)$item['id'] ?>">

      <div class="grid">
        <div>
          <label>Item Name</label>
          <input type="text" name="item_name" value="<?= htmlspecialchars($item['item_name']) ?>" required>

          <label>Price ($)</label>
          <input type="number" step="0.01" min="0" name="item_price" value="<?= htmlspecialchars((string)$item['item_price']) ?>" required>

          <label>Category</label>
          <select name="item_category" required>
            <?php foreach (['Electronics','Clothing','Furniture','Vehicles'] as $c): ?>
              <option <?= ($c===($item['item_category']??''))?'selected':'' ?> value="<?= htmlspecialchars($c) ?>"><?= htmlspecialchars($c) ?></option>
            <?php endforeach; ?>
          </select>
        </div>
        <div>
          <label>Description</label>
          <textarea name="item_desc"><?= htmlspecialchars($item['item_desc'] ?? '') ?></textarea>
        </div>
      </div>

      <h3>Existing Images</h3>
      <div class="imgs">
        <?php if (!empty($images)): foreach ($images as $im): ?>
          <label class="tile">
            <img src="<?= htmlspecialchars($im['image_path']) ?>" alt="">
            <div><input type="checkbox" name="remove_image[]" value="<?= (int)$im['id'] ?>"> Remove</div>
          </label>
        <?php endforeach; else: ?>
          <p>No images yet.</p>
        <?php endif; ?>
      </div>

      <h3>Add Images (max 5 total)</h3>
      <input type="file" name="new_images[]" accept="image/*" multiple>

      <div class="actions">
        <button class="btn" type="submit">Save Changes</button>
        <a class="btn secondary" href="profile.php">Cancel</a>
      </div>
    </form>
  </div>
</div>
</body>
</html>
